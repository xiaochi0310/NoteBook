### 区块链学习

------

### 一、基本概念

#### 1、区块链的基本概念：

区块链实际是一种分布式数据存储、点对点传输（P2P）、共识算法、加密算法等计算机技术的新型应用模式。具有分布式对等、数据块链式、不可伪造和防篡改、透明可信、高可靠等特征。

区块链部署模型：

1、公有链：任意客户都能使用、任意节点均可接入，所有节点共同参与共识和读写数据，具有较强的去中心化特征，比特币和以太坊

2、联盟链：只有利益相关的特定区块链服务客户才能使用，节点只有经过授权许可后方可接入网络，接入节点按照规则参与共识和读写数据，具有较弱的去中心化的特征，如Hyperledger Fabric

3、私有链：仅由单个区块链服务客户使用，仅有授权的节点才能接入，并按照规则参与共识和读写数据

目前，区块链系统包括共识机制、安全机制、存储机制、P2P通信机制、智能合约等核心技术

#### 2、共识机制

在区块链系统中，共识机制是指实现不同信任主体节点之间建立信任、获取权益的数学算法，提供给分布式网络参识节点以用于确认交易动作引起的账本中的状态数据变化，并且能够达成最终一致性

常见的共识机制包括PoW、PoS、DPoS、PBFT等

PoW(Proof of Work,工作量证明)  // 待补充

PoS(Proof of Stake，权益证明)

DPos(Delegated Proof of Stake,股份授权证明)

PBFT(Practical Byzantine Fault Tolerance,实用拜占庭容错)

#### 3、P2P

PeerToPeer 节点之间直接通过交换方式共享信息，又被称为对等计算

Hyperledger Fabric采用gRPC库与Gossip消息协议构建P2P通信机制

#### 4、智能合约

HyperledgerFabric采用Docker容器等作为智能合约执行的虚拟机，所有智能合约（Hyperledger Fabric称之为chaincode，即链上代码或链码）都必须实现Init()与Invoke()方法。

### 二、Peer节点

peer节点提供背书、交易验证、提交账本等服务功能的逻辑节点（包括Endorser背书节点、Committer记账节点）

#### 1、Endorser背书节点

负责接收来自客户端的签名提案消息请求，检查消息后模拟执行交易提案，并对模拟执行结果签名背书，即使用私钥对请求提案、状态变更（读写集）等签名，表示Endorser背书节点认为此次交易是合法有效的，然后将签名背书信息等打包成提案响应消息回复给客户端；

#### 2、 Committer记账节点

负责检查交易消息结构的完整性与合法性、调用VSCC验证交易背书策略、执行MVCC检查读写集冲突等，标记交易的有效性并提交账本，更新本地账本数据库与文件，包括区块数据文件、隐私数据库、区块索引数据库、状态数据库、历史数据库等。

### 三、Orderor节点

Orderer排序节点同样属于逻辑节点，负责管理系统通道与应用通道，维护通道账本与配置，提供Broadcast交易广播服务、Orderer共识排序服务、Deliver区块分发服务等

Orderer节点通过Broadcast()服务接口接收与处理交易消息请求（普通交易消息与配置交易消息），过滤检查后提交共识组件进行排序，并添加到本地待处理的缓存交易消息列表，按照约定的交易出块规则（如配置出块时间、配置出块字节数限制、通道配置消息单独出块等）切割打包成新区块，再保存到本地账本的区块数据文件中

Orderer节点通过Deliver()服务接口接收与处理区块请求消息，从本地账本中获取请求范围内的区块数据回复给请求节点

### 四、客户端Client

#### 1、Fabric-CA客户端

负责节点注册登记，包括登记注册用户信息、获取注册证书与私钥信息等；

####  2、Fabric客户端

负责网络配置与节点管理，包括初始化与更新配置、启动和停止节点等。同时，还负责通道管理（创建、更新、查询等）与链码生命周期管理（安装、实例化、调用、升级等），能够通过Peer节点服务客户端发送消息给Endorser节点与Orderer节点请求处理，包括交易背书、创建通道、更新通道配置、交易排序、请求区块数据等。负责与其他服务节点进行交互，提供配置操作、通道操作、链码操作、节点操作、日志操作等相关API接口，支持开发丰富的应用程序



